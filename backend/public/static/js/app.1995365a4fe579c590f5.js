webpackJsonp([1],{"1Bjh":function(e,t){},"2Axr":function(e,t){},"3+Xn":function(e,t){},"3oll":function(e,t,i){"use strict";var s=i("fZjL"),n=i.n(s),r=i("Zrlr"),l=i.n(r),o=i("wxAW"),a=i.n(o),h=function(){function e(){l()(this,e)}return a()(e,[{key:"create",value:function(e,t,i){this.tabArea=document.createElement("div"),this.tab=document.createElement("ul"),this.tab.classList.add("tab-wrap"),this.tabArea.appendChild(this.tab),this.tabElements={},this.arr=[],this.tabIndex=-1,this.activeTabIndex=-1,this.baseTabId=t,this.baseTabName=i,this.addBtn=null,e.appendChild(this.tabArea)}},{key:"addTab",value:function(){this.tabIndex++;var e=this.baseTabId+this.tabIndex;if(null==this.addBtn){var t=document.createElement("li");t.classList.add("add-tab-li");var i=document.createElement("div");i.classList.add("add-tab-btn"),i.classList.add("icon-plus"),t.appendChild(i),this.tab.appendChild(t),this.addBtn=t,t.addEventListener("click",this.addTab.bind(this))}var s=document.createElement("li");s.classList.add("tab-label"),s.classList.add("noselect"),s.setAttribute("tab-control",e),s.setAttribute("tab-index",this.tabIndex),s.addEventListener("click",this._activate.bind(this));var n=document.createElement("span");n.classList.add("tab-anchor"),n.innerText=this.baseTabName+this.tabIndex;var r=document.createElement("span");r.classList.add("closebtn-sm"),r.innerHTML="&#10006;",r.addEventListener("click",this.closeTab.bind(this)),s.appendChild(n),s.appendChild(r),this.tab.insertBefore(s,this.addBtn);var l=document.createElement("div");l.classList.add("tab-content"),l.id=e,this.tabArea.appendChild(l),this.tabElements[this.tabIndex]=s;var o={tab:s,content:l,tabIndex:this.tabIndex};return this.afterAddTabCallback&&this.afterAddTabCallback(o),o}},{key:"afterAddTab",value:function(e){this.afterAddTabCallback=e}},{key:"_activate",value:function(e){var t=void 0;t=e.target.classList.contains("tab-anchor")?e.target.parentElement.getAttribute("tab-index"):e.target.getAttribute("tab-index"),this.activate(t)}},{key:"activate",value:function(e){if(this.tabElements[e]){if(this.tabElements[this.activeTabIndex]){var t=this.tabElements[this.activeTabIndex];t.classList.remove("active"),document.getElementById(t.getAttribute("tab-control")).classList.remove("active-tab-content")}this.activeTabIndex=e;var i=this.tabElements[e];i.classList.add("active"),document.getElementById(i.getAttribute("tab-control")).classList.add("active-tab-content")}}},{key:"closeTab",value:function(e){if(n()(this.tabElements).length>1){var t=e.target.parentElement,i=parseInt(t.getAttribute("tab-index")),s=document.getElementById(t.getAttribute("tab-control")),r=t.previousSibling,l=t.nextSibling;t.parentElement.removeChild(t),this.tabArea.removeChild(s),delete this.tabElements[i],this.activeTabIndex==i&&(r?this.activate(r.getAttribute("tab-index")):this.activate(l.getAttribute("tab-index")))}}}]),e}();t.a=h},"66Oe":function(e,t){},EdfF:function(e,t){},"F/8I":function(e,t){},GHPP:function(e,t){},IcnI:function(e,t,i){"use strict";var s=i("7+uW"),n=i("NYxO"),r=i("424j"),l=i("Xxa5"),o=i.n(l),a=i("exGp"),h=i.n(a),d={namespaced:!0,state:{tenant:"",username:"",token:"",inprogress:!1},mutations:{create:function(e,t){e.tenant="",e.token=t.token,e.username=t.username,e.serverUrl=t.serverUrl},destroy:function(e){e.tenant="",e.username="",e.token="",e.serverUrl=""},request:function(e){e.inprogress=!0}},actions:{create:function(e,t){var i=this,s=e.commit,n=e.dispatch;return h()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n("http/post",{url:"/login",data:t},{root:!0}).then(function(e){return s("create",e.data)}).catch(function(e){return e.message});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}))()},destroy:function(e,t){var i=this,s=e.commit,n=e.dispatch;return h()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n("http/delete",{url:"/logout",data:t},{root:!0}).then(function(e){return console.log("destroy done"),s("create",e.data)}).catch(function(e){return e}).finally(function(e){return s("destroy")});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}))()},request:function(e,t){var i=this,s=(e.commit,e.dispatch);return h()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("request"),e.next=3,s("http/post",{url:t.url,data:t.data},{root:!0}).then(function(e){return e.data});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,i)}))()}}},c=i("mtWM"),u=i.n(c),v={namespaced:!0,actions:{request:function(e,t){var i=this,s=(e.dispatch,e.rootState),n=t.method,r=t.url,l=t.data;t.error;return h()(o.a.mark(function e(){var t,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t={})["Content-Type"]="application/json",s.auth.token&&(t.Authorization=s.auth.token,t["User-Id"]=s.auth.username,t["Server-Url"]=s.auth.serverUrl),a={method:n,url:r,headers:t,data:l,timeout:15e3},console.log("ax"),e.next=7,u()(a).then(function(e){return console.log(e),e}).catch(function(e){throw console.log(e),new Error(e.response.data)});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,i)}))()},post:function(e,t){var i=this,s=e.dispatch;return h()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.method="post",e.next=3,s("request",t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,i)}))()},delete:function(e,t){var i=this,s=e.dispatch;return h()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.method="delete",e.next=3,s("request",t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,i)}))()}}};s.a.use(n.a);t.a=new n.a.Store({modules:{auth:d,http:v},plugins:[Object(r.a)({key:"xxxproject",storage:window.sessionStorage})]})},M93x:function(e,t,i){"use strict";var s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var n=i("VU/8")({name:"App",computed:{token:function(){return this.$store.state.auth.token}},watch:{token:function(e){this.$store.state.auth.token?this.$router.push("/"):this.$router.push("/login")}}},s,!1,function(e){i("MtXV")},null,null);t.a=n.exports},MtXV:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=i("7+uW"),s=i("M93x"),n=i("YaEn"),r=i("IcnI"),l=i("7t+N"),o=i.n(l),a=i("n0nz"),h=i("3oll");e.jQuery=o.a,e.$=o.a,window.$=window.jQuery=i("7t+N"),e.GridTable=a.a,e.Tab=h.a,t.a.config.productionTip=!1,new t.a({router:n.a,store:r.a,components:{App:s.a},template:"<App />"}).$mount("#app")}.call(t,i("DuR2"))},NKJb:function(e,t){},RGmE:function(e,t){},YaEn:function(e,t,i){"use strict";var s=i("7+uW"),n=i("/ocq"),r={data:function(){return{message:"",username:"",password:""}},methods:{login:function(){var e=this;this.$store.dispatch("auth/create",{username:this.username,password:this.password}).then(function(t){console.log("eee"),console.log(t),e.message=t})}},created:function(){console.log("login created"),this.$store.state.auth.token&&this.$router.push("/")}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"loginFormArea"}},[i("div",{attrs:{id:"loginMessageArea"}},[i("div",{attrs:{id:"loginMessage"}},[e._v(e._s(e.message))])]),e._v(" "),i("div",{staticClass:"login-form"},[i("form",[i("div",{staticClass:"header"}),e._v(" "),i("div",{staticClass:"input-area"},[i("div",[i("div",[e._v("User Name")]),e._v(" "),i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",id:"username",value:""},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})])]),e._v(" "),i("div",[i("div",[e._v("Password")]),e._v(" "),i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",value:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})])]),e._v(" "),e._m(0)]),e._v(" "),i("div",{staticClass:"button-area"},[i("button",{staticClass:"btn login-btn",on:{click:function(t){return e.login()}}},[e._v("Login")])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",[this._v("Environment")]),this._v(" "),t("div",{staticClass:"selection"},[t("input",{attrs:{type:"radio",id:"production",name:"envtype",checked:""}}),t("label",{staticClass:"radio",attrs:{for:"production"}},[this._v("Production")]),this._v(" "),t("input",{attrs:{type:"radio",id:"sandbox",name:"envtype"}}),t("label",{staticClass:"radio",attrs:{for:"sandbox"}},[this._v("Sandbox")])])])}]};var o=i("VU/8")(r,l,!1,function(e){i("hPbX")},"data-v-838f9276",null).exports,a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"requesting-overlay",class:this.state,attrs:{id:"overlay"}},[t("div",{staticClass:"overlay-content noselect",attrs:{id:"overlayContent"}},[this._v(this._s(this.message))]),this._v(" "),t("div",{staticClass:"loader"})])},staticRenderFns:[]};var h=i("VU/8")({props:["message"],data:function(){return{displayed:!1}},computed:{state:function(){return this.displayed?"overlay-displayed":"overlay-hidden"}},methods:{changeMessage:function(e){this.message=e},showOverlay:function(){this.displayed=!0},hideOverlay:function(){this.displayed=!1}}},a,!1,function(e){i("fZDT")},null,null).exports,d={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:{"show-progress":this.inprogress,"hide-progress":!this.inprogress},attrs:{id:"progress"}},[t("div",{class:{"progress-line":this.inprogress},attrs:{id:"progress-line"}})])},staticRenderFns:[]};var c=i("VU/8")({computed:{inprogress:function(){return this.$store.state.auth.inprogress}}},d,!1,function(e){i("2Axr")},"data-v-3c260044",null).exports,u={data:function(){return{currentUser:this.$store.state.auth.username,opened:!1}},computed:{dropdownStatus:function(){return this.opened?"open":""}},methods:{logout:function(){console.log("destroy"),this.$store.dispatch("auth/destroy"),console.log("destroy and push")},onDropdownClick:function(e){this.opened=!this.opened}}},v={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"user-list",class:e.dropdownStatus,attrs:{id:"userList"}},[i("button",{staticClass:"btn dropdown-btn",attrs:{id:"username",type:"button"},on:{click:e.onDropdownClick,blur:e.onDropdownClick}},[e._v(e._s(e.currentUser))]),e._v(" "),i("ul",{staticClass:"dropdown-menu",attrs:{id:"dropdownMenu"}},[e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),i("li",{staticClass:"divider",attrs:{role:"separator"}}),e._v(" "),i("li",[i("a",{on:{mousedown:function(t){return e.logout()}}},[e._v("Logout")])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("li",{staticClass:"dropdown-submenu"},[t("a",{attrs:{id:"changeLocale"}},[this._v("Locale Option")]),this._v(" "),t("ul",{staticClass:"dropdown-menu locale-options"},[t("li",[t("a",{attrs:{"locale-option":"ja"}},[this._v("Japanese")])]),this._v(" "),t("li",[t("a",{attrs:{"locale-option":"en_US"}},[this._v("English")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("a",{attrs:{id:"refreshSObjects"}},[this._v("Refresh sObjects")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("a",{attrs:{id:"refreshMetadata"}},[this._v("Refresh Metadata")])])}]};var p=i("VU/8")(u,v,!1,function(e){i("GHPP")},"data-v-285177d4",null).exports,f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{attrs:{id:"menus"}},[i("li",[i("a",{staticClass:"menu-item",class:{displayed:"soql"==e.current},attrs:{id:"soql"},on:{click:e.onMenuClick}},[e._v("SOQL")])]),e._v(" "),e._m(0),e._v(" "),i("li",[i("a",{staticClass:"menu-item",class:{displayed:"apex"==e.current},attrs:{id:"apex"},on:{click:e.onMenuClick}},[e._v("Apex")])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("a",{staticClass:"menu-item",attrs:{id:"describe"}},[this._v("Describe")])])}]};var g=i("VU/8")({data:function(){return{current:"soql"}},methods:{onMenuClick:function(e){var t=e.target.id;this.current=t,this.$emit("change",{target:this.current})}}},f,!1,function(e){i("EdfF")},"data-v-00606c72",null).exports,m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"message-area",class:this.state},[t("div",{staticClass:"message"},[this._v(this._s(this.message))])])},staticRenderFns:[]};var C=i("VU/8")({data:function(){return{message:"",displayed:!1}},computed:{state:function(){return this.displayed?"message-displayed":"message-hidden"}},methods:{displayError:function(e){this.message=e,this.displayed=!0},hideMessageArea:function(){this.message="",this.displayed=!1}}},m,!1,function(e){i("F/8I")},"data-v-4ca2f5d1",null).exports,y={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"sidenav",class:e.navstatus,attrs:{id:"history"}},[i("div",{staticClass:"tbl soql-history-title noselect"},[i("div",{staticClass:"row"},[i("button",{staticClass:"closebtn noselect",on:{click:e.onCloseHistoryClick}},[e._v("×")])]),e._v(" "),i("div",{staticClass:"row"},[e._v(e._s(e.header))])]),e._v(" "),i("div",{staticClass:"soql-list"},[i("ul",e._l(e.items,function(t,s){return i("li",{key:s,attrs:{title:t},on:{dblclick:e.onHistoryDblClick}},[e._v(e._s(t))])}),0)])])},staticRenderFns:[]};var b={data:function(){return{tabComponent:new Tab,sObjects:{}}},computed:{},methods:{onHistoryButtonClick:function(e){this.$emit("requestOpenHistory")},createTab:function(e){var t=e.tabIndex;this.tabComponent.activate(e.tabIndex);var i=document.createElement("div");i.classList.add("result-tab"),i.setAttribute("tabId",t);var s=document.createElement("div");s.classList.add("result-info"),s.setAttribute("tabId",t);var n=document.createElement("div");n.classList.add("soql-info-area");var r=document.createElement("div");r.id="soqlInfo"+t,r.innerText="0 rows";var l=document.createElement("div");l.classList.add("rerun"),l.classList.add("refresh-sm");var o=document.createElement("div");o.classList.add("refresh-btn-sm"),l.appendChild(o),n.appendChild(r),n.appendChild(l),s.appendChild(n);var a=document.createElement("div");a.id="soqlGrid"+t,a.classList.add("result-grid"),a.setAttribute("tabId",t),i.appendChild(s),i.appendChild(a),e.content.appendChild(i)},getActiveTabElementId:function(){return this.tabComponent.activeTabIndex},getActiveGridElementId:function(){return"soqlGrid"+getActiveTabElementId()},setQueryResult:function(e){var t="soqlGrid"+e.soqlInfo.tabId,i=new GridTable(document.getElementById(t),{rows:e.rows,header:e.columns});this.$set(this.sObjects,e.soqlInfo.tabId,{grid:i,soql:e.soqlInfo.soql})},rerun:function(e){var t=this.getActiveTabElementId();this.sObjects[t]&&this.$emit("onExecuteRequest",this.sObjects[t].soql)},exportCsv:function(){var e=this.getActiveGridElementId(),t=this.sObjects[e].grid;t&&t.export({fileName:"query_result",bom:!0})}},mounted:function(){this.tabComponent.afterAddTab(this.createTab),this.tabComponent.create(document.getElementById("soqlTabArea"),"soqlTab","Grid"),this.tabComponent.addTab()}},w={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tab-area",attrs:{div:"",id:"soqlTabArea"}},[t("button",{staticClass:"btn btn-sub",attrs:{type:"button",id:"soqlHistoryBtn"},on:{click:this.onHistoryButtonClick}},[this._v("History")]),this._v(" "),t("button",{staticClass:"btn btn-sub export",attrs:{type:"button"},on:{click:this.exportCsv}},[this._v("Export")])])},staticRenderFns:[]};var x={data:function(){return{selector:"#soqlArea",tooling:!1,inputSoql:"select firstname,Name,Id,account.name from contact where id in ('0036F00003Vhe7y','0036F00003WqLC4')",sidenavOpened:!1}},components:{message:C,soqlhistory:i("VU/8")({props:["header","container"],data:function(){return{opened:!1,items:[]}},computed:{navstatus:function(){return this.opened?"sidenav-open":"sidenav-close"}},methods:{toggle:function(){this.opened?this.closeHistory():this.openHistory()},onCloseHistoryClick:function(e){this.closeHistory()},onHistoryDblClick:function(e){this.$emit("navItemDblclicked",this.container,e.target.innerHTML)},openHistory:function(){this.opened=!0,this.$emit("navChanged",this.opened,this.container)},closeHistory:function(){this.opened=!1,this.$emit("navChanged",this.opened,this.container)},addItem:function(e){this.items.push(e)}}},y,!1,function(e){i("3+Xn")},null,null).exports,soqltab:i("VU/8")(b,w,!1,function(e){i("yDJI")},null,null).exports},computed:{displayPosition:function(){return this.sidenavOpened?"with-sidenav":"without-sidenav"}},methods:{showTest:function(){var e=this;this.$refs.message.hideMessageArea(),this.$store.dispatch("auth/request",{url:"/test",data:{}}).then(function(t){return e.displayQueryResult3(t)}).catch(function(t){return e.$refs.message.displayError(t)})},displayQueryResult3:function(e){new GridTable(document.getElementById("soqlGrid0"),e)},onExecuteSoqlBtn:function(e){this.executeSoql()},executeSoql:function(e){var t=this,i=e||this.inputSoql;i&&this.$store.dispatch("auth/request",{url:"/soql",data:{soql:i,tooling:this.tooling,tabId:this.$refs.tab.getActiveTabElementId()}}).then(function(e){return t.displayQueryResult(e)}).catch(function(e){return t.$refs.message.displayError(e)})},displayQueryResult:function(e){this.$refs.tab.setQueryResult(e),this.$refs.history.addItem(e.soqlInfo.soql)},openHistory:function(){this.$refs.history.toggle()},onHistoryStatusChanged:function(e){this.sidenavOpened=e},onHistoryItemSelected:function(e,t){e==this.selector&&(document.getElementById("inputSoql").value=t)}}},k={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.displayPosition,attrs:{id:"soqlArea"}},[i("soqlhistory",{ref:"history",attrs:{header:"SOQL History",container:e.selector},on:{navChanged:e.onHistoryStatusChanged,navItemDblclicked:e.onHistoryItemSelected}}),e._v(" "),i("div",{staticClass:"form-area soql-form"},[i("div",[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.inputSoql,expression:"inputSoql"}],staticClass:"code-input",attrs:{id:"inputSoql",spellcheck:"false",cols:"120",rows:"5"},domProps:{value:e.inputSoql},on:{input:function(t){t.target.composing||(e.inputSoql=t.target.value)}}})]),e._v(" "),i("div",[i("button",{staticClass:"btn btn-main",attrs:{type:"button",id:"executeSoqlBtn"},on:{click:e.onExecuteSoqlBtn}},[e._v("Execute")]),e._v(" "),i("button",{staticClass:"btn btn-main",attrs:{type:"button",id:"test"},on:{click:e.showTest}},[e._v("Test")]),e._v(" "),i("label",{staticClass:"soql-options"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.tooling,expression:"tooling"}],attrs:{type:"checkbox",id:"useTooling"},domProps:{checked:Array.isArray(e.tooling)?e._i(e.tooling,null)>-1:e.tooling},on:{change:function(t){var i=e.tooling,s=t.target,n=!!s.checked;if(Array.isArray(i)){var r=e._i(i,null);s.checked?r<0&&(e.tooling=i.concat([null])):r>-1&&(e.tooling=i.slice(0,r).concat(i.slice(r+1)))}else e.tooling=n}}}),e._v(" Use Tooling API")])]),e._v(" "),i("message",{ref:"message"})],1),e._v(" "),i("soqltab",{ref:"tab",on:{onExecuteRequest:function(t){return e.executeSoql(t)},requestOpenHistory:e.openHistory}})],1)},staticRenderFns:[]};var I=i("VU/8")(x,k,!1,function(e){i("RGmE")},null,null).exports,S=i("fZjL"),N=i.n(S),E={data:function(){return{tabIds:{},baseTabIndex:0,currentTabId:0,logs:{}}},computed:{name:function(){return this.hasName?this.logs[this.currentTabId].name:null},hasName:function(){return!!this.logs[this.currentTabId]}},methods:{onTabClick:function(e){this.currentTabId=e.target.getAttribute("tabId")},closeTab:function(e){var t=this;e.stopPropagation(),N()(this.tabIds).length<=1||(e.target.parentElement.remove(),this.$delete(this.tabIds,e.target.getAttribute("tabId")),this.$nextTick(function(){$("#apexArea .tab-area").tabs("refresh"),t.setSortableAttribute()}))},addTab:function(e){this.createTab()},createTab:function(){var e=this;this.baseTabIndex++,this.currentTabId=this.baseTabIndex,this.$set(this.tabIds,this.baseTabIndex,this.baseTabIndex),this.$nextTick(function(){$("#apexArea .tab-area").tabs("refresh");var t=$("#apexArea .tab-area ul li").length-2;e.setSortableAttribute(),$("#apexArea .tab-area").tabs({active:t})})},setSortableAttribute:function(){N()(this.tabIds).length>1?$("#apexTabs").sortable("enable"):$("#apexTabs").sortable("disable")},getActiveGridElementId:function(){return"#apexGrid"+this.currentTabId},setLog:function(e,t){var i="#apexGrid"+e,s=new GridTable(document.querySelector(i),t.data);this.$set(this.logs,e,{name:t.name,grid:s})},debugOnly:function(e){e.target.checked?this.filterLog():this.clearFilter()},filterLog:function(){this.logs[this.currentTabId].grid.filter(1,"USER_DEBUG")},clearFilter:function(){this.logs[this.currentTabId].grid.clearFilter()},exportCsv:function(){var e=this.logs[this.currentTabId].grid;e&&e.export({fileName:_logNames[elementId],bom:!0})}},mounted:function(){$("#apexArea .tab-area").tabs(),$("#apexTabs").sortable({items:"li:not(.add-tab-li)",delay:150}),this.createTab()}},H={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tab-area"},[i("button",{staticClass:"btn btn-xs btn-default export",attrs:{type:"button"},on:{click:e.exportCsv}},[e._v("Export")]),e._v(" "),i("ul",{attrs:{id:"apexTabs"}},[e._l(e.tabIds,function(t){return i("li",{key:t,staticClass:"noselect"},[i("a",{attrs:{href:"#apexTab"+t,tabId:t},on:{click:e.onTabClick}},[e._v("Grid"+e._s(t))]),e._v(" "),i("span",{staticClass:"ui-icon ui-icon-close ui-closable-tab",attrs:{tabId:t},on:{click:e.closeTab}})])}),e._v(" "),i("li",{staticClass:"add-tab-li"},[i("div",{staticClass:"add-tab-btn icon-plus",on:{click:e.addTab}})])],2),e._v(" "),e._l(e.tabIds,function(t){return i("div",{key:t,staticClass:"result-tab",attrs:{id:"apexTab"+t,tabId:t}},[i("div",{staticClass:"result-info",attrs:{id:"logInfo"+t,tabId:t}},[i("span",[e._v(e._s(e.name))]),e._v(" "),i("label",[i("input",{staticClass:"debug-only",attrs:{type:"checkbox",disabled:!e.hasName},on:{change:e.debugOnly}}),e._v("  Debug only")])]),e._v(" "),i("div",{staticClass:"result-grid",attrs:{id:"apexGrid"+t,tabId:t}})])})],2)},staticRenderFns:[]};var R={components:{message:C,apextab:i("VU/8")(E,H,!1,function(e){i("NKJb")},null,null).exports},methods:{onExecuteClick:function(e){var t=$("#apexArea #apexCode").val();if($.isAjaxBusy()||!t)return!1;e.preventDefault(),this.executeAnonymous(t)},executeAnonymous:function(e){this.$refs.message.hideMessageArea(),this.selectedTabId=this.$refs.tab.currentTabId;var t={};$("#debugOptions option:selected").each(function(){var e=$(this).parent().attr("id"),i=$(this).val();t[e]=i});var i={code:e,debug_options:t},s=$.getAjaxOptions("/apex","post",i,"",null),n=$.getAjaxCallbacks(this.afterExecuteAnonymous,this.$refs.message.displayError,null);$.executeAjax(s,n)},afterExecuteAnonymous:function(e){this.$refs.tab.setLog(this.selectedTabId,e)}}},_={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"apexArea"}},[t("div",{staticClass:"form-area execute-anonymous-form"},[this._m(0),this._v(" "),t("div",[t("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button",id:"executeAnonymousBtn"},on:{click:this.onExecuteClick}},[this._v("Execute Anonymous")])]),this._v(" "),t("p",[t("message",{ref:"message"})],1)]),this._v(" "),t("apextab",{ref:"tab"})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("textarea",{staticClass:"code-input",attrs:{id:"apexCode",spellcheck:"false",cols:"120",rows:"5"}})])}]};var A={data:function(){return{selectedArea:"soql"}},components:{overlay:h,"progress-line":c,dropdown:p,menus:g,soql:I,apex:i("VU/8")(R,_,!1,function(e){i("66Oe")},null,null).exports},created:function(){window.addEventListener("keydown",this.onkeydown)},methods:{onkeydown:function(e){!e.ctrlKey||"r"!==e.key&&13!==e.keyCode||(e.preventDefault(),"inputSoql"===e.target.id&&this.$refs.soql.executeSoql(),"apexCode"===e.target.id&&this.$refs.apex.onExecuteClick(e)),9===e.keyCode&&("inputSoql"!==e.target.id&&"apexCode"!==e.target.id||(e.preventDefault(),this.insertTab(e)))},insertTab:function(e){var t=e.target,i=t.selectionStart,s=t.selectionEnd;t.value=t.value.substring(0,i)+"\t"+t.value.substring(s),t.selectionStart=t.selectionEnd=i+1},onMenuChanged:function(e){this.selectedArea=e.target}}},L={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.selectedArea,attrs:{id:"mainArea","current-locale-option":""}},[i("overlay",{attrs:{message:"Loading..."}}),e._v(" "),i("div",{staticClass:"header"},[i("progress-line"),e._v(" "),i("div",{attrs:{id:"menuList"}},[i("dropdown"),e._v(" "),i("menus",{on:{change:e.onMenuChanged}})],1)],1),e._v(" "),i("div",{attrs:{id:"contentsArea"}},[i("div",{attrs:{id:"soqlContent"}},[i("soql",{ref:"soql"})],1),e._v(" "),i("div",{attrs:{id:"describeContent"}}),e._v(" "),i("div",{attrs:{id:"apexContent"}},[i("apex",{ref:"apex"})],1)])],1)},staticRenderFns:[]};var T=i("VU/8")(A,L,!1,function(e){i("1Bjh")},null,null).exports,B=i("IcnI");s.a.use(n.a);var D=new n.a({routes:[{path:"/",name:"main",component:T,meta:{isPublic:!1}},{path:"/login",name:"login",component:o,meta:{isPublic:!0}}]});D.beforeEach(function(e,t,i){e.matched.some(function(e){return e.meta.isPublic})||B.a.state.auth.token?(console.log("next"),console.log(e),i()):(console.log("next login"),i("/login"))});t.a=D},fZDT:function(e,t){},hPbX:function(e,t){},n0nz:function(e,t,i){"use strict";var s=i("fZjL"),n=i.n(s),r=i("c/Tr"),l=i.n(r),o=i("lHA8"),a=i.n(o),h=i("Zrlr"),d=i.n(h),c=i("wxAW"),u=i.n(c),v=1,p=2,f=3,g=4,m=5,C=6,y={Cell:1,Row:2,Column:3,All:4},b={None:0,Column:1,Row:2},w=function(){function e(t,i){d()(this,e),this.rootNode=t,this.rootNode.innerHTML="",this.rootHeight=i.height?i.height:500,this.rows=i.rows,this.header=i.header,this._rows=null,Array.isArray(i.readOnly)?(this.readOnly=!1,this.readOnlyColumns=new a.a(i.readOnly)):(this.readOnly=i.readOnly,this.readOnlyColumns=new a.a),this.baseRowHeight=22,this.headerHeight=28,this.itemCount=this.rows.length,this.totalContentHeight=0,this.childPositions=null,this.columnPositions=null,this.columnValues=null,this.startNode=0,this.endNode=0,this.visibleNodesCount=0,this.filteredIndex=new Array(this.itemCount).fill(null).map(function(e,t){return t}),this.visibleIndex=this.filteredIndex,this.nodeOffsetY=0,this.nodeOffsetX=0,this.visibleViewportHeight=0,this.calculationBaseStyles={baseHeight:this.baseRowHeight,font:"12px Verdana,Arial,sans-serif",lineHeight:21,borderWidth:1,padding:35},this.sizeBase=N.getSizeBase(this.header,this.rows,this.calculationBaseStyles),this.updateColumnInfo(),this.lastPostion={X:0,Y:0},this.scrollPosition={X:0,Y:0},this.scrollCallback=null,this.filtered=!1,this.sorted=!1,this.isDragging=!1,this.isResizing=!1,this.isSearching=!1,this.container=null,this.table=null,this.table=null,this.visibleNodes=null,this.focusHolder=null,this.cornerCell=null,this.rowHeaderCellsVirtual=[],this.columnHeaderCells=[],this.current=null,this.last=null,this.nextCell=null,this.selection=new k,this.virtualSelection=new k,this.animationFrame=null,this.resizeAnimationFrame=null,this.scrollInterval=null,this.sortInfo={order:1,columnIndex:0},this.history=new S(this.rows),this.searchUtil=new I,this.dropdown=new E(this.rootNode,{afterDropdownClose:this.onDropdownClose.bind(this),clearFilter:this.onDropdownClear.bind(this)}),this.currentSelectionMode=y.Cell,this.currentResizeMode=b.None,this.rootNode.style.height="100%",this.rootNode.style.position="relative",this.rootNode.style.overflow="hidden",this.assignHandler(document,"mousedown",this.onDocumentMouseDown),this.assignHandler(document,"mouseup",this.onDocumentMouseUp),this.assignHandler(document,"copy",this.onDocumentCopy),this.assignHandler(document,"mousemove",this.onDocumentMouseMove),this.mouseoverEvent=document.createEvent("HTMLEvents"),this.mouseoverEvent.initEvent("mouseover",!0,!0),this.mouseoverEvent.eventName="mouseover",this.prepareVirtualScroll(0,0,!0),this.createGridTable()}return u()(e,[{key:"assignHandler",value:function(e,t,i){null==this.rows||this.rows.length<=0||e.addEventListener(t,i.bind(this))}},{key:"prepareVirtualScroll",value:function(e,t,i){var s=this;i&&(this.childPositions=function(){for(var e=[0],t=1;t<s.filteredIndex.length;t++)e.push(e[t-1]+s.getChildHeight(s.filteredIndex[t]-1));return e}(),this.totalContentHeight=this.childPositions[this.filteredIndex.length-1]+this.getChildHeight(this.filteredIndex.length-1));var n=N.findClosest(e,this.childPositions,this.itemCount),r=function(e,t,i,s){var n=void 0;for(n=t;n<i;n++)if(e[n]>e[t]+s)return n;return n}(this.childPositions,n,this.itemCount,this.rootHeight);this.startNode=Math.max(0,n-20),this.endNode=Math.min(this.itemCount-1,r+20),this.visibleNodesCount=this.endNode-this.startNode+1,this.visibleIndex=this.filteredIndex.slice(this.startNode,this.startNode+this.visibleNodesCount),this.visibleViewportHeight=this.rootHeight-this.headerHeight,this.nodeOffsetY=this.childPositions[this.startNode],this.nodeOffsetX=t}},{key:"getChildHeight",value:function(e){return this.sizeBase.heights[e]}},{key:"createGridTable",value:function(){var e=this;this.viewport=document.createElement("div"),this.viewport.style.height=this.rootHeight+"px",this.viewport.classList.add("gtbl-viewport"),this.assignHandler(this.viewport,"scroll",this.onRootScroll);var t,i,s,n,r,o=((i=document.createElement("div")).classList.add("gtbl-row","gtbl-row-header"),e.cornerCell=((t=document.createElement("div")).classList.add("gtbl-header-cell","gtbl-corner-cell"),t.style.width=e.rowHeaderWidth+"px",e.assignHandler(t,"click",e.onCornerCellClick),t),i.appendChild(e.cornerCell),e.header.forEach(function(t,s){var n=document.createElement("div");n.classList.add("gtbl-header-cell","gtbl-col-header-cell"),n.style.width=e.columnWidths[s]+"px",e.assignHandler(n,"click",e.onColumnHeaderCellClick);var r=document.createElement("a");r.classList.add("sort-link"),r.textContent=t,e.assignHandler(r,"click",e.onSortLinkClick);var l=document.createElement("span");l.classList.add("sort-icon");var o=document.createElement("div");o.classList.add("filter-btn"),e.assignHandler(o,"click",e.onFilterColumnClick);var a=document.createElement("div");a.classList.add("arrow-down"),o.appendChild(a);var h=document.createElement("div");h.classList.add("col-slidebar"),e.assignHandler(h,"mousedown",e.onSlidebarMousedown),n.append(r,l,o,h),e.columnHeaderCells.push(n),i.appendChild(n)}),i);this.viewport.appendChild(o),this.container=((s=document.createElement("div")).classList.add("gtbl-container"),s.style.height=e.totalContentHeight+"px",s),this.table=((n=document.createElement("div")).classList.add("gtbl","gtbl-grid"),n.style.top="0px",n),this.table.appendChild(this.getVisibleChildNodes()),this.visibleNodes=l()(this.table.childNodes),this.container.appendChild(this.table),this.viewport.appendChild(this.container),this.rootNode.appendChild(this.viewport),this.focusHolder=((r=document.createElement("input")).classList.add("focus-holder"),r.type="text",e.assignHandler(r,"keydown",e.onFocusHolderKeydown),e.assignHandler(r,"keypress",e.onFocusHolderKeypress),e.assignHandler(r,"keyup",e.onFocusHolderKeyUp),e.assignHandler(r,"paste",e.onFocusHolderPaste),r),this.rootNode.appendChild(this.focusHolder),this.inputHolder=function(){e.editor=document.createElement("textarea"),e.editor.spellcheck=!1,e.editor.classList.add("cell-editor"),e.assignHandler(e.editor,"blur",e.onEditorBlur),e.assignHandler(e.editor,"keydown",e.onEditorKeydown),e.assignHandler(e.editor,"keypress",e.onEditorKeypress),e.assignHandler(e.editor,"paste",e.onEditorPaste);var t=document.createElement("div");return t.classList.add("input-holder"),t.appendChild(e.editor),t}(),this.viewport.appendChild(this.inputHolder),this.dialog=function(){var t=document.createElement("div");t.classList.add("dialog"),t.style.top=e.headerHeight+1+"px",t.style.right="20px";var i=document.createElement("textarea");return i.spellcheck=!1,i.classList.add("dialog-txt"),e.assignHandler(i,"keydown",e.onSearchDialogKeydown),e.searchResultArea=document.createElement("div"),e.searchResultArea.classList.add("search-result"),e.searchResultArea.textContent="0/0",t.appendChild(i),t.appendChild(e.searchResultArea),t}(),this.rootNode.appendChild(this.dialog)}},{key:"createRow",value:function(e){var t=this,i=this.rows[e],s=document.createElement("div");s.classList.add("gtbl-row","gtbl-detail");var n=document.createElement("div");n.classList.add("gtbl-header-cell","gtbl-row-header-cell"),n.style.height=this.getChildHeight(e)+"px",this.assignHandler(n,"click",this.onRowHeaderCellClick);var r=document.createElement("span");r.classList.add("row-number"),r.textContent=e+1,n.appendChild(r);var l=document.createElement("div");l.classList.add("row-slidebar"),this.assignHandler(l,"mousedown",this.onRowSlidebarMousedown),n.appendChild(l),n.style.width=this.rowHeaderWidth+"px",this.rowHeaderCellsVirtual.push(n),s.appendChild(n);var o=document.createDocumentFragment();return i.forEach(function(e,i){var s=document.createElement("div");s.classList.add("gtbl-value-cell"),s.textContent=N.toStringNullSafe(e),t.assignHandler(s,"mousedown",t.onCellMouseDown),t.assignHandler(s,"mouseup",t.onCellMouseUp),t.assignHandler(s,"mouseover",t.onCellMouseOver),t.assignHandler(s,"dblclick",t.onCellDblClick),s.style.width=t.columnWidths[i]+"px",o.appendChild(s)}),s.appendChild(o),s}},{key:"getVisibleChildNodes",value:function(){var e=this;this.rowHeaderCellsVirtual=[];var t=document.createDocumentFragment();return this.visibleIndex.forEach(function(i){return t.appendChild(e.createRow(i))}),t}},{key:"getRowDataAt",value:function(e,t){return null==t?[e+1].concat(this.rows[e]):[t+1].concat(this.rows[e])}},{key:"changeRowValue",value:function(e,t,i){var s,n,r=this;t>this.visibleNodes.length-1&&(s=t,n=r.createRow(s),r.visibleNodes.push(n),r.table.appendChild(n));var l=t+this.startNode;e.forEach(function(e,s){var n=r.visibleNodes[t].childNodes[s];0==s?(n.style.height=r.getChildHeight(l)+"px",n.childNodes[0].textContent=N.toStringNullSafe(e)):n.textContent=N.toStringNullSafe(e),i||(function(e,t){return!(!r.isSearching||r.searchUtil.CurrentResult.RowIndex!=e||r.searchUtil.CurrentResult.ColumnIndex!=t-1)||!!r.current&&r.current.Cell.RowIndex==e&&r.current.Cell.ColumnIndex==t-1}(l,s)&&(r.markCurrent(n,!0),r.isEditing&&r.prepareEditor()),function(e,t){return!(!r.isSearching||r.searchUtil.CurrentResult.RowIndex!=e||r.searchUtil.CurrentResult.ColumnIndex!=t-1)||!!r.last&&r.last.Cell.RowIndex==e&&r.last.Cell.ColumnIndex==t-1}(l,s)&&(r.last=r.toCellNode(n)))})}},{key:"doVirtualScroll",value:function(e){this.prepareVirtualScroll(e.target.scrollTop,e.target.scrollLeft),this.current&&this.clearCurrent(),this.isEditing&&this.initEditor(),this.alterViewportOffset(),this.alterContent();var t=this.visibleNodes.length-0-this.visibleNodesCount;this.visibleNodes.splice(this.visibleNodesCount,t).forEach(function(e){return e.remove()}),this.rowHeaderCellsVirtual.splice(this.visibleNodesCount,t),this.changeHighlightByScroll(),this.scrollCallback&&(this.scrollCallback.action(this.scrollCallback.args),this.scrollCallback=null)}},{key:"alterContent",value:function(e){var t=this;this.sorted?this.visibleIndex.map(function(e,i){return t.getRowDataAt(e,i)}).forEach(function(i,s){return t.changeRowValue(i,s,e)}):this.visibleIndex.map(function(e){return t.getRowDataAt(e)}).forEach(function(i,s){return t.changeRowValue(i,s,e)})}},{key:"alterViewportOffset",value:function(){this.table.style.top=this.nodeOffsetY+"px"}},{key:"alterScrollPosition",value:function(e,t){null!=e&&(this.viewport.scrollTop=e),null!=t&&(this.viewport.scrollLeft=t)}},{key:"moveCellByCtrlArrowKey",value:function(e,t){this.bypassHighlightByScroll=!t,this.shiftKey=t;var i=void 0;i=t?this.last:this.current;var s=this.viewport.scrollTop,n=this.viewport.scrollLeft;switch(e){case C:this.alterScrollPosition(this.viewport.scrollHeight,this.viewport.scrollWidth);break;case m:this.alterScrollPosition(0,0);break;case f:this.alterScrollPosition(null,0);break;case g:this.alterScrollPosition(null,this.viewport.scrollWidth);break;case v:this.alterScrollPosition(0);break;case p:this.alterScrollPosition(this.viewport.scrollHeight)}s!=this.viewport.scrollTop||n!=this.viewport.scrollLeft?this.scrollCallback=this.createCallback(this.changeCellByCtrlArrowKey,{anchor:i,direction:e}):this.changeCellByCtrlArrowKey({anchor:i,direction:e})}},{key:"indexOf",value:function(e){return Array.prototype.indexOf.call(e.parentNode.childNodes,e)}},{key:"rowIndexOf",value:function(e){return Array.prototype.indexOf.call(this.rowHeaderCellsVirtual,e)}},{key:"changeCellByCtrlArrowKey",value:function(e){var t=void 0,i=void 0;switch(e.direction){case C:i=(t=this.visibleNodes[this.visibleNodes.length-2]).childNodes[t.childNodes.length-1];break;case m:i=(t=this.visibleNodes[0]).childNodes[1];break;case f:i=(t=this.visibleNodes[this.indexOf(e.anchor.Node.parentNode)]).childNodes[1];break;case g:i=(t=this.visibleNodes[this.indexOf(e.anchor.Node.parentNode)]).childNodes[t.childNodes.length-1];break;case v:i=(t=this.visibleNodes[0]).childNodes[this.indexOf(e.anchor.Node)];break;case p:i=(t=this.visibleNodes[this.visibleNodes.length-2]).childNodes[this.indexOf(e.anchor.Node)]}this.shiftKey?this.selectByShift(i):this.selectByMouseDown(i)}},{key:"moveCellByArrowKey",value:function(e,t){var i=this;this.bypassHighlightByScroll=!t,this.shiftKey=t;var s=void 0;(function(e,t){switch(e){case f:if(t.Cell.ColumnIndex<=0)return!1;break;case g:if(t.Cell.ColumnIndex==i.header.length-1)return!1;break;case v:if(0==t.Cell.RowIndex)return!1;break;case p:if(t.Cell.RowIndex+1==i.rows.length)return!1}return!0})(e,s=t?this.last:this.current)&&(this.scrollRequired(s)?this.scrollCallback=this.createCallback(this.changeCellByArrowKey,{direction:e}):this.changeCellByArrowKey({direction:e}))}},{key:"createCallback",value:function(e,t){return{action:e.bind(this),args:t}}},{key:"changeCellByArrowKey",value:function(e){var t=void 0,i=void 0;switch(i=this.shiftKey?this.last:this.current,e.direction){case m:t=i.Node.parentNode.childNodes[1];break;case C:t=i.Node.parentNode.childNodes[this.header.length];break;case f:t=i.Node.previousElementSibling;break;case g:t=i.Node.nextElementSibling;break;case v:t=i.Node.parentNode.previousElementSibling.childNodes[this.indexOf(i.Node)];break;case p:t=i.Node.parentNode.nextElementSibling.childNodes[this.indexOf(i.Node)]}this.shiftKey?this.alterLast(t):this.selectByMouseDown(t)}},{key:"scrollRequired",value:function(e){var t=!1,i=null,s=null,n=this.viewport.scrollTop,r=this.viewport.scrollLeft,l=this.childPositions[e.Cell.RowIndex],o=this.columnPositions[e.Cell.ColumnIndex];(l>n+this.visibleViewportHeight&&(s=l,t=!0),l<n&&(s=l,t=!0),r>o&&(i=o-this.rowHeaderWidth,t=!0),N.css(this.viewport,"width")+r<o)&&(i=o-(o-(N.css(this.viewport,"width")+r))+(N.css(this.viewport,"width")-this.viewport.clientWidth),t=!0);return t&&this.alterScrollPosition(s,i),t}},{key:"hasFocus",value:function(){return document.activeElement==this.focusHolder}},{key:"setFocus",value:function(){this.focusHolder.focus()}},{key:"selectByMouseDown",value:function(e){this.markCurrent(e),this.last=this.current,this.updateSelection(this.current.Cell.RowIndex,this.current.Cell.RowIndex,this.current.Cell.ColumnIndex,this.current.Cell.ColumnIndex),this.updateVirtualSelection(this.current)}},{key:"selectByShift",value:function(e){this.clearSelection(),this.last=this.toCellNode(e),this.updateVirtualSelection(this.last),this.updateSelection(this.current.Cell.RowIndex,this.last.Cell.RowIndex,this.current.Cell.ColumnIndex,this.last.Cell.ColumnIndex),this.changeHighlight(e)}},{key:"markCurrent",value:function(e,t){this.clearSelection(),this.current&&this.clearCurrent(),this.current=this.toCellNode(e),this.current.Node.classList.add("current"),this.rowHeaderCellsVirtual[this.indexOf(e.parentNode)].classList.add("row-highlight"),this.columnHeaderCells[this.indexOf(e)-1].classList.add("row-highlight"),t||(this.scrollHorizontally(e),this.scrollVertically(e))}},{key:"clearCurrent",value:function(){this.current.Node.classList.remove("current")}},{key:"changeHighlight",value:function(e){var t=this.container,i=this.indexOf(e)-1,s=this.indexOf(e.parentNode);this.resetSelection();for(var n=Math.min(s,this.virtualSelection.Start.RowIndex),r=Math.max(s,this.virtualSelection.Start.RowIndex),l=Math.min(i,this.virtualSelection.Start.ColumnIndex),o=Math.max(i,this.virtualSelection.Start.ColumnIndex),a=n;a<=r;a++){var h=t.querySelectorAll(".gtbl-detail")[a].querySelectorAll(".gtbl-value-cell");this.rowHeaderCellsVirtual[a].classList.add("row-highlight");for(var d=l;d<=o;d++)h[d].classList.add("highlight"),this.columnHeaderCells[d].classList.add("row-highlight")}this.updateSelection(this.current.Cell.RowIndex,s+this.startNode,l,o)}},{key:"scrollHorizontally",value:function(e,t){var i=0,s=this.toCellNode(e).Cell,n=this.viewport.scrollLeft,r=this.columnPositions[s.ColumnIndex];if(this.lastPostion.X!=r&&(this.lastPostion.X=r,!(n+r-this.rowHeaderWidth<=0)))if(this.viewport.scrollWidth!=r+this.columnWidths[s.ColumnIndex])if(n>0&&0==s.ColumnIndex)this.alterScrollPosition(null,0);else{if(n>=r)return t&&(i=this.columnWidths[this.last.Cell.ColumnIndex-1]),void this.alterScrollPosition(null,r-this.rowHeaderWidth-i);if(n+N.css(this.viewport,"width")<=this.columnPositions[s.ColumnIndex+1]+this.getScrollbarHeight()){var l=this.columnPositions[s.ColumnIndex+1]+this.getScrollbarHeight()-(n+N.css(this.viewport,"width"));return t&&(i=this.columnWidths[this.last.Cell.ColumnIndex]),void this.alterScrollPosition(null,n+l+i)}}else this.alterScrollPosition(null,this.viewport.scrollWidth)}},{key:"scrollVertically",value:function(e,t){var i=0,s=this.toCellNode(e).Cell,n=this.childPositions[s.RowIndex],r=this.viewport.scrollTop;if(this.lastPostion.Y!=n&&(this.lastPostion.Y=n,!(r+n<=0)))if(this.totalContentHeight!=n+this.getChildHeight(s.RowIndex))if(r>0&&0==s.RowIndex)this.alterScrollPosition(0);else{if(r>n)return t&&(i=this.getChildHeight(this.current.Cell.RowIndex-1)),void this.alterScrollPosition(n-i);if(r+this.visibleViewportHeight<=this.childPositions[s.RowIndex+1]+this.getScrollbarHeight()){var l=this.childPositions[s.RowIndex+1]+this.getScrollbarHeight()-(r+this.visibleViewportHeight);return t&&(i=this.getChildHeight(this.last.Cell.RowIndex+1)),void this.alterScrollPosition(r+l+i)}}else this.alterScrollPosition(this.viewport.scrollHeight)}},{key:"getScrollbarHeight",value:function(){return this.rootHeight-this.viewport.clientHeight}},{key:"changeHighlightByScroll",value:function(){var e=this;if(e.currentSelectionMode!=y.All&&e.currentSelectionMode!=y.Column&&(e.bypassHighlightByScroll||!e.current||!e.last||e.current.Cell.equals(e.last.Cell)))return!0;if(this.clearSelection(),e.currentSelectionMode!=y.All&&e.currentSelectionMode!=y.Column&&(e.current.Cell.RowIndex>=e.last.Cell.RowIndex?e.current.Cell.RowIndex<e.startNode||e.last.Cell.RowIndex>e.startNode+e.visibleNodesCount-1:e.last.Cell.RowIndex<e.startNode||e.current.Cell.RowIndex>e.startNode+e.visibleNodesCount-1))return!0;this.updateVirtualSelection(this.last);var t=Math.min(this.virtualSelection.End.RowIndex,this.virtualSelection.Start.RowIndex),i=Math.max(this.virtualSelection.End.RowIndex,this.virtualSelection.Start.RowIndex),s=Math.min(this.virtualSelection.End.ColumnIndex,this.virtualSelection.Start.ColumnIndex),n=Math.max(this.virtualSelection.End.ColumnIndex,this.virtualSelection.Start.ColumnIndex);this.currentSelectionMode==y.All&&this.cornerCell.classList.add("row-highlight"),this.currentSelectionMode==y.Row&&this.columnHeaderCells.forEach(function(e){return e.classList.add("row-highlight")});for(var r=t;r<=i;r++){var l=this.container.querySelectorAll(".gtbl-detail")[r].querySelectorAll(".gtbl-value-cell");this.rowHeaderCellsVirtual[r].classList.add("row-highlight");for(var o=s;o<=n;o++)l[o].classList.add("highlight"),this.currentSelectionMode!=y.Row&&this.columnHeaderCells[o].classList.add("row-highlight")}}},{key:"updateVirtualSelection",value:function(e){return this.currentSelectionMode==y.All?(this.virtualSelection.Start.RowIndex=0,this.virtualSelection.End.RowIndex=this.visibleNodesCount-1,this.virtualSelection.Start.ColumnIndex=0,void(this.virtualSelection.End.ColumnIndex=this.header.length-1)):this.currentSelectionMode==y.Column?(this.virtualSelection.Start.RowIndex=0,void(this.virtualSelection.End.RowIndex=this.visibleNodesCount-1)):(this.current.Cell.RowIndex>=e.Cell.RowIndex?(this.virtualSelection.Start.RowIndex=Math.min(this.visibleNodesCount-1,this.current.Cell.RowIndex-this.startNode),this.virtualSelection.End.RowIndex=Math.max(0,this.last.Cell.RowIndex-this.startNode)):(this.virtualSelection.Start.RowIndex=Math.max(0,this.current.Cell.RowIndex-this.startNode),this.virtualSelection.End.RowIndex=Math.min(this.visibleNodesCount-1,this.last.Cell.RowIndex-this.startNode)),this.virtualSelection.Start.ColumnIndex=this.current.Cell.ColumnIndex,void(this.virtualSelection.End.ColumnIndex=e.Cell.ColumnIndex))}},{key:"selectAll",value:function(){var e=this;this.currentSelectionMode=y.All,this.cornerCell.classList.add("row-highlight"),this.visibleNodes.forEach(function(t){t.childNodes.forEach(function(t,i){i>0&&e.highlightSelection(t)})}),this.updateSelection(0,this.rows.length-1,0,this.header.length-1)}},{key:"selectRow",value:function(e){this.currentSelectionMode=y.Row;var t=parseInt(e.textContent)-1;this.markCurrent(e.nextElementSibling,!0),this.last=this.toCellNode(e.parentNode.childNodes[this.header.length]),this.columnHeaderCells.forEach(function(e){return e.classList.add("row-highlight")}),e.parentNode.childNodes.forEach(function(e,t){t>0?e.classList.add("highlight"):e.classList.add("row-highlight")}),this.updateSelection(t,t,0,this.header.length-1),this.setFocus()}},{key:"selectColumn",value:function(e){var t=this;this.currentSelectionMode=y.Column;var i=this.indexOf(e);this.markCurrent(this.visibleNodes[0].childNodes[i],!0),this.current.Cell.RowIndex=0,this.last=this.toCellNode(this.visibleNodes[this.visibleNodes.length-1].childNodes[i]),e.classList.add("row-highlight"),this.visibleNodes.forEach(function(e,s){t.rowHeaderCellsVirtual[s].classList.add("row-highlight"),e.childNodes[i].classList.add("highlight")}),this.virtualSelection.Start.ColumnIndex=i-1,this.virtualSelection.End.ColumnIndex=i-1,this.updateSelection(0,this.rows.length-1,i-1,i-1),this.setFocus()}},{key:"highlightSelection",value:function(e){e.classList.add("highlight"),this.rowHeaderCellsVirtual[this.indexOf(e.parentNode)].classList.add("row-highlight"),this.columnHeaderCells.forEach(function(e){return e.classList.add("row-highlight")})}},{key:"clearSelection",value:function(){this.cornerCell.classList.remove("row-highlight"),this.table.querySelectorAll(".highlight").forEach(function(e){return e.classList.remove("highlight")}),this.rowHeaderCellsVirtual.forEach(function(e){return e.classList.remove("row-highlight")}),this.columnHeaderCells.forEach(function(e){return e.classList.remove("row-highlight")})}},{key:"toCellNode",value:function(e){return{Node:e,Cell:new x(this.indexOf(e.parentNode)+this.startNode,this.indexOf(e)-1)}}},{key:"updateSelection",value:function(e,t,i,s){this.selection.Start=new x(Math.min(e,t),Math.min(i,s)),this.selection.End=new x(Math.max(e,t),Math.max(i,s))}},{key:"resetSelection",value:function(){this.selection=new k}},{key:"resetViewport",value:function(){this.current=null,this.last=null,this.resetSelection(),this.itemCount=this.filteredIndex.length,this.prepareVirtualScroll(0,0,!0),this.container.style.height=this.totalContentHeight+"px",this.alterViewportOffset(),this.table.innerHTML="",this.table.appendChild(this.getVisibleChildNodes()),this.visibleNodes=l()(this.table.childNodes),this.alterScrollPosition(0,0)}},{key:"resizeColumn",value:function(e){e.stopPropagation(),e.preventDefault();var t=e.pageX-this.lastSliderPosition;this.lastSliderPosition=e.pageX;var i=N.css(this.resizingCell.Node,"width")+t;i>2&&(this.resizingCell.Node.style.width=i+"px",this.firstRowCell.style.width=i+"px")}},{key:"resizeRow",value:function(e){e.stopPropagation(),e.preventDefault();var t=e.pageY-this.lastSliderPosition;this.lastSliderPosition=e.pageY;var i=N.css(this.resizingCell.Node,"height")+t;i>2&&(this.resizingCell.Node.style.height=i+"px")}},{key:"moveSlidebar",value:function(e){var t=this;this.isResizing&&(this.resizeAnimationFrame&&window.cancelAnimationFrame(this.resizeAnimationFrame),this.resizeAnimationFrame=window.requestAnimationFrame(function(){return t.resizeFrame(e)}))}},{key:"updateColumnInfo",value:function(){this.rowHeaderWidth=this.sizeBase.widths[0],this.columnWidths=this.sizeBase.widths.filter(function(e,t){return t>0}),this.columnPositions=[this.rowHeaderWidth];for(var e=1;e<this.columnWidths.length;e++)this.columnPositions.push(this.columnPositions[e-1]+this.columnWidths[e-1]);this.columnValues=this.sizeBase.baseData.map(function(e){return N.uniq(e)})}},{key:"keepScroll",value:function(e){var t=this,i=function(e){var i=t.last.Cell.RowIndex,s=t.last.Cell.ColumnIndex;switch(e){case v:return i>0?t.last.Node.parentNode.previousElementSibling.childNodes[t.indexOf(t.last.Node)]:null;case p:return i<t.rows.length-1?t.last.Node.parentNode.nextElementSibling.childNodes[t.indexOf(t.last.Node)]:null;case f:return s>0?t.last.Node.previousElementSibling:null;case g:return s<t.header.length-1?t.last.Node.nextElementSibling:null}}(e);i?!function(e,i){var s=t.toCellNode(i),n=void 0;if(!s.Node){switch(e){case v:n=t.childPositions[t.startNode-1];break;case p:n=t.childPositions[t.endNode+1]}return t.alterScrollPosition(n),i=null,!0}return t.scrollRequired(s)}(e,i)?this.triggerCellMouseOver({nextCell:i,direction:e}):this.scrollCallback=this.createCallback(this.triggerCellMouseOver,{nextCell:i,direction:e}):this.resetInterval()}},{key:"triggerCellMouseOver",value:function(e){if(!e.nextCell)switch(e.direction){case v:e.nextCell=this.visibleNodes[0].childNodes[this.indexOf(this.last.Node)];break;case p:e.nextCell=this.visibleNodes[this.visibleNodes.length-1].childNodes[this.indexOf(this.last.Node)]}e.nextCell.dispatchEvent(this.mouseoverEvent)}},{key:"alterLast",value:function(e){this.selectByShift(e),this.scrollHorizontally(e),this.scrollVertically(e)}},{key:"resetInterval",value:function(){this.scrollInterval&&(window.clearInterval(this.scrollInterval),this.scrollInterval=null)}},{key:"onRootScroll",value:function(e){var t=this,i=e.target.scrollLeft,s=e.target.scrollTop;this.scrollPosition.X!=i&&this.dropdown.IsOpened&&this.dropdown.close(),this.scrollPosition.X=i,this.scrollPosition.Y=s,this.animationFrame&&window.cancelAnimationFrame(this.animationFrame),this.animationFrame=window.requestAnimationFrame(function(){return t.doVirtualScroll(e)})}},{key:"onSlidebarMousedown",value:function(e){this.isResizing=!0,this.currentResizeMode=b.Column,this.resizeFrame=this.resizeColumn,this.lastSliderPosition=e.pageX,this.resizingCell=this.toCellNode(e.target.parentNode),this.resizingCell.Node.classList.add("noselect"),this.viewport.style.cursor="col-resize",this.firstRowCell=this.visibleNodes[0].childNodes[this.indexOf(this.resizingCell.Node)]}},{key:"onRowSlidebarMousedown",value:function(e){this.isResizing=!0,this.currentResizeMode=b.Row,this.resizeFrame=this.resizeRow,this.lastSliderPosition=e.pageY,this.resizingCell=this.toCellNode(e.target.parentNode),this.resizingCell.Node.classList.add("noselect"),this.viewport.style.cursor="row-resize"}},{key:"onDocumentMouseDown",value:function(e){this.isDragging=!1,this.resetInterval()}},{key:"onDocumentMouseUp",value:function(e){this.isDragging=!1,this.resetInterval(),this.currentResizeMode==b.Row?(this.sizeBase.heights[this.resizingCell.Cell.RowIndex]=N.css(this.resizingCell.Node,"height"),this.rowHeaderCellsVirtual[this.rowIndexOf(this.resizingCell.Node)].style.height=N.css(this.resizingCell.Node,"height")+"px",this.prepareVirtualScroll(this.viewport.scrollTop,this.viewport.scrollLeft,!0),this.container.style.height=this.totalContentHeight+"px",this.alterViewportOffset()):this.currentResizeMode==b.Column&&(this.sizeBase.widths[this.resizingCell.Cell.ColumnIndex+1]=N.css(this.resizingCell.Node,"width"),this.columnHeaderCells[this.resizingCell.Cell.ColumnIndex].style.width=N.css(this.resizingCell.Node,"width")+"px",this.updateColumnInfo()),this.isResizing&&(this.isResizing=!1,this.currentResizeMode=b.None,this.resizingCell.Node.classList.remove("noselect"),this.viewport.style.cursor="default")}},{key:"onDocumentMouseMove",value:function(e){var t=this;return this.moveSlidebar(e),!this.hasFocus()||!this.isDragging||(e.target.classList.contains("gtbl-value-cell")||e.target.classList.contains("gtbl-header-cell")?(this.resetInterval(),!0):(this.resetInterval(),void(this.scrollInterval=window.setInterval(this.keepScroll.bind(this),50,function(e){var i=t.viewport.getBoundingClientRect();return e.clientX<i.left?f:e.clientX>N.css(t.viewport,"width")?g:e.clientY<i.top?v:e.clientY>i.top?p:null}(e)))))}},{key:"onDocumentCopy",value:function(e){this.hasFocus()&&this.copyToClipboard(e)}},{key:"onCornerCellClick",value:function(e){this.setFocus(),this.selectAll()}},{key:"onCloneHeaderClick",value:function(e){this.isEditing&&this.endEdit(),this.selectRow(this.rowHeaderCellsVirtual[this.indexOf(this.current.Node.parentNode)])}},{key:"onEditorKeydown",value:function(e){if("Enter"==e.key)if(e.preventDefault(),e.altKey||e.ctrlKey){var t=this.editor.value+"\n";this.editor.value=t;var i=this.calculateEditorSize(t+"\n");this.editor.style.height=i.height+"px"}else this.endEdit(),this.moveCellByArrowKey(p,!1)}},{key:"onEditorKeypress",value:function(e){var t=this.calculateEditorSize(this.editor.value+e.key);this.editor.style.width=t.width+"px",this.editor.style.height=t.height+"px"}},{key:"onFocusHolderPaste",value:function(e){e.preventDefault();var t=N.getClipboardText(e);this.beginEdit(t);var i=this.calculateEditorSize(this.editor.value);this.editor.style.width=i.width+"px",this.editor.style.height=i.height+"px"}},{key:"onEditorPaste",value:function(e){e.preventDefault();var t=N.getClipboardText(e),i=this.editor.value,s=this.editor.selectionStart,n=i.slice(0,s)+t+i.slice(s);this.editor.value=n;var r=this.calculateEditorSize(this.editor.value);this.editor.style.width=r.width+"px",this.editor.style.height=r.height+"px"}},{key:"onEditorBlur",value:function(e){this.isEditing&&this.endEdit()}},{key:"onFocusHolderKeyUp",value:function(e){if(this.shiftKey&&"Shift"==e.key&&(this.isDragging=!1),"F2"==e.key)return this.beginEdit(),!1}},{key:"onFocusHolderKeydown",value:function(e){if(!this.hasFocus())return!0;if(e.ctrlKey&&"a"===e.key)return e.preventDefault(),void this.selectAll();if(e.ctrlKey&&"z"===e.key)return e.preventDefault(),void this.undoEdit();if(e.ctrlKey&&"y"===e.key)return e.preventDefault(),void this.redoEdit();if("Enter"==e.key)return e.preventDefault(),void this.moveCellByArrowKey(p,!1);if("F3"==e.key&&"block"==this.dialog.style.display)return e.preventDefault(),void(e.shiftKey?this.doSearch(v):this.doSearch(p));if(e.ctrlKey&&"f"==e.key)return e.preventDefault(),this.openSearchDialog(),void this.dialog.childNodes[0].focus();if("Escape"==e.key&&(e.preventDefault(),this.closeSearchDialog()),e.ctrlKey)switch(e.key){case"End":return e.preventDefault(),this.moveCellByCtrlArrowKey(C,e.shiftKey),!1;case"Home":return e.preventDefault(),this.moveCellByCtrlArrowKey(m,e.shiftKey),!1;case"ArrowLeft":return e.preventDefault(),this.moveCellByCtrlArrowKey(f,e.shiftKey),!1;case"ArrowRight":return e.preventDefault(),this.moveCellByCtrlArrowKey(g,e.shiftKey),!1;case"ArrowUp":return e.preventDefault(),this.moveCellByCtrlArrowKey(v,e.shiftKey),!1;case"ArrowDown":return e.preventDefault(),this.moveCellByCtrlArrowKey(p,e.shiftKey),!1}switch(e.key){case"End":return e.preventDefault(),this.moveCellByArrowKey(C),!1;case"Home":return e.preventDefault(),this.moveCellByArrowKey(m),!1;case"ArrowLeft":return e.preventDefault(),this.moveCellByArrowKey(f,e.shiftKey),!1;case"ArrowRight":return e.preventDefault(),this.moveCellByArrowKey(g,e.shiftKey),!1;case"ArrowUp":return e.preventDefault(),this.moveCellByArrowKey(v,e.shiftKey),!1;case"ArrowDown":return e.preventDefault(),this.moveCellByArrowKey(p,e.shiftKey),!1}}},{key:"onFocusHolderKeypress",value:function(e){return e.preventDefault(),this.beginEdit(e.key),this.onEditorKeypress(e),!1}},{key:"onSearchDialogKeydown",value:function(e){"Enter"==e.key&&(e.preventDefault(),this.doSearch(p)),"F3"==e.key&&(e.preventDefault(),e.shiftKey?this.doSearch(v):this.doSearch(p)),"Escape"==e.key&&(e.preventDefault(),this.closeSearchDialog(),this.setFocus())}},{key:"onCellDblClick",value:function(e){this.beginEdit()}},{key:"onCellMouseUp",value:function(e){this.isDragging=!1}},{key:"onCellMouseDown",value:function(e){e.stopPropagation(),this.setFocus(),this.mouseButton=e.button;var t=e.target;e.preventDefault(),this.isDragging=!0,this.bypassHighlightByScroll=!1,this.currentSelectionMode=y.Cell,e.shiftKey?this.selectByShift(t):this.selectByMouseDown(t)}},{key:"onCellMouseOver",value:function(e){if(this.isDragging&&0==this.mouseButton){var t=e.target;if(this.clearSelection(),this.last=this.toCellNode(t),this.current.Cell.equals(this.last.Cell))return this.rowHeaderCellsVirtual[this.indexOf(t.parentNode)].classList.add("row-highlight"),void this.columnHeaderCells[this.indexOf(t)-1].classList.add("row-highlight");this.changeHighlight(t),this.scrollHorizontally(t,!0),this.scrollVertically(t,!0)}}},{key:"onRowHeaderCellClick",value:function(e){this.resizingCell?this.resizingCell=null:this.selectRow(e.target)}},{key:"onColumnHeaderCellClick",value:function(e){this.resizingCell?this.resizingCell=null:void 0!==window.getSelection&&window.getSelection().toString()||this.selectColumn(e.target)}},{key:"onSortLinkClick",value:function(e){e.stopPropagation(),this.selectColumn(e.target.parentNode);var t=this.indexOf(e.target.parentNode)-1;this.sort(t),this.columnHeaderCells.forEach(function(e){return e.classList.remove("sorted")}),e.target.parentNode.classList.add("sorted")}},{key:"onFilterColumnClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.toggleDropdown(e)}},{key:"onDropdownClose",value:function(e,t){this.dropdown.filtered?(this.filtered&&this.undoFilter(),this.filter(e,t)):this.filtered&&this.clearFilter()}},{key:"onDropdownClear",value:function(){this.clearFilter()}},{key:"toggleDropdown",value:function(e){var t=this.indexOf(e.target.parentNode)-1,i={X:e.target.parentNode.offsetLeft-this.viewport.scrollLeft-3,Y:e.target.parentNode.offsetTop+this.headerHeight+1,width:parseInt(e.target.parentNode.style.width.replace("px",""))};this.dropdown.open(t,this.columnValues[t],i)}},{key:"beginEdit",value:function(e){this.current&&(this.isEditing=!0,this.prepareEditor(e),this.readOnly||this.readOnlyColumns.has(this.current.Cell.ColumnIndex)?this.editor.setAttribute("readOnly","true"):(this.editor.removeAttribute("readOnly"),this.history.begin(this.current,this.current.Node.textContent,this.sizeBase.heights[this.current.Cell.RowIndex])),this.editor.focus())}},{key:"prepareEditor",value:function(e){var t=this.viewport.scrollLeft,i=this.current.Node.getBoundingClientRect().left-this.viewport.getBoundingClientRect().left+t,s=this.childPositions[this.current.Cell.RowIndex];this.inputHolder.style.position="absolute",this.inputHolder.style.top=s+this.headerHeight+"px",this.inputHolder.style.left=i+"px",this.editor.style.width=N.css(this.current.Node,"width")+"px",this.editor.style.height=N.css(this.current.Node,"height")+"px",this.editor.value="",this.editor.value=e||this.current.Node.textContent}},{key:"endEdit",value:function(){this.isEditing=!1,this.current.Node.textContent=this.editor.value,this.history.end(this.editor.value,this.sizeBase.heights[this.current.Cell.RowIndex]),this.initEditor(),this.recalculateViewport(),this.setFocus()}},{key:"endUndoRedo",value:function(e){this.sizeBase.heights[e.CellNode.Cell.RowIndex]=e.height,this.recalculateViewport()}},{key:"initEditor",value:function(){this.editor.style.width="0px",this.editor.style.height="0px",this.inputHolder.style.position="fixed",this.inputHolder.style.top="-100px",this.inputHolder.style.left="-100px"}},{key:"undoEdit",value:function(){if(this.history.canUndo()){var e=this.history.undo();this.endUndoRedo(e),this.selectByMouseDown(e.CellNode.Node)}}},{key:"redoEdit",value:function(){if(this.history.canRedo()){var e=this.history.redo();this.endUndoRedo(e),this.selectByMouseDown(e.CellNode.Node)}}},{key:"calculateEditorSize",value:function(e){var t=e.split("\n").reduce(function(e,t){return N.compareLength(e,t)}),i=N.getStringWidth(t,!1,this.calculationBaseStyles)-28;i<=N.css(this.current.Node,"width")&&(i=N.css(this.current.Node,"width"));var s=N.measureHeight(this.calculationBaseStyles,e);return s>this.sizeBase.heights[this.current.Cell.RowIndex]?this.sizeBase.heights[this.current.Cell.RowIndex]=s:s=this.getChildHeight(this.current.Cell.RowIndex),{width:i,height:s}}},{key:"recalculateViewport",value:function(){this.prepareVirtualScroll(this.viewport.scrollTop,this.viewport.scrollLeft,!0),this.container.style.height=this.totalContentHeight+"px",this.alterViewportOffset()}},{key:"doSearch",value:function(e){var t=null==this.current?0:this.current.Cell.RowIndex,i=this.dialog.childNodes[0].value,s=this.searchUtil.search(this.rows,i,e,t);if(this.searchResultArea.textContent=this.searchUtil.ResultText,s){this.isSearching=!0;var n={Node:null,Cell:new x(this.searchUtil.CurrentResult.RowIndex,this.searchUtil.CurrentResult.ColumnIndex)};if(0==this.scrollRequired(n)){var r=this.searchUtil.CurrentResult.RowIndex-this.startNode,l=this.searchUtil.CurrentResult.ColumnIndex+1;this.selectByMouseDown(this.visibleNodes[r].childNodes[l])}this.isSearching=!1}}},{key:"closeSearchDialog",value:function(){this.table.querySelectorAll(".found").forEach(function(e){return e.classList.remove("found")}),this.dialog.classList.remove("open")}},{key:"openSearchDialog",value:function(){this.dialog.classList.add("open")}},{key:"filter",value:function(e,t){this.filtered||(this.filtered=!0,this._rows=this.filteredIndex,this.filteredIndex=[],Array.isArray(t)?this._filterByValues(e,t):this._filterByValue(e,t),this.resetViewport())}},{key:"_filterByValue",value:function(e,t){var i=this;this.rows.forEach(function(s,n){s.forEach(function(s,r){if(r==e&&s==t)return i.filteredIndex.push(n),!1})})}},{key:"_filterByValues",value:function(e,t){var i=this;this.rows.forEach(function(s,n){s.forEach(function(s,r){if(r==e&&t.includes(s))return i.filteredIndex.push(n),!1})})}},{key:"clearFilter",value:function(){this.filtered&&(this.filtered=!1,this.filteredIndex=this._rows,this._rows=[],this.resetViewport())}},{key:"undoFilter",value:function(){this.filtered=!1,this.filteredIndex=this._rows,this._rows=[]}},{key:"copyToClipboard",value:function(e){e.preventDefault();var t=function(e){var t=N.toStringNullSafe(e);return t.includes("\n")?'"'+t+'"':t},i=[];this.currentSelectionMode==y.All&&i.push(this.header.map(function(e){return t(e)}).join("\t"));for(var s=this.selection.Start.RowIndex;s<=this.selection.End.RowIndex;s++)i.push(this.rows[this.filteredIndex[s]].slice(this.selection.Start.ColumnIndex,this.selection.End.ColumnIndex+1).map(function(e){return t(e)}).join("\t"));(e.clipboardData||window.clipboardData||e.originalEvent.clipboardData).setData("text/plain",i.join("\n"))}},{key:"export",value:function(e){var t=e.delimitter?e.delimitter:",",i=e.extension?e.extension:".csv",s=e.fileName?e.fileName:"export",n=e.bom?new Uint8Array([239,187,191]):null,r=['"',",","\n","\r","\r\n"],l=function(e){return r.some(function(t){return e.includes(t)})?'"'+e+'"':e},o=void 0;o=!e.includeHeader||e.includeHeader?[this.header].concat(this.rows).map(function(e){return e.map(function(e){return l(N.toStringNullSafe(e))}).join(t)}).join("\n"):this.rows.map(function(e){return e.map(function(e){return l(N.toStringNullSafe(e))}).join(t)}).join("\n");var a=void 0;a=n?new Blob([n,o],{type:"text/csv"}):new Blob([o],{type:"text/csv"});var h=document.createElement("a");h.href=(window.URL?URL:webkitURL).createObjectURL(a),h.download=s+i,this.viewport.append(h),h.click(),h.remove()}},{key:"sort",value:function(e){var t=this;this.sorted=!0,0==this.sortInfo.order?this.columnHeaderCells[this.sortInfo.columnIndex].classList.remove("sorted-asc"):this.columnHeaderCells[this.sortInfo.columnIndex].classList.remove("sorted-desc");var i=0==this.sortInfo.order?1:0;0===i?this.filteredIndex.sort(function(i,s){return N.toStringNullSafe(t.rows[i][e]).localeCompare(N.toStringNullSafe(t.rows[s][e]))}):this.filteredIndex.sort(function(i,s){return N.toStringNullSafe(t.rows[s][e]).localeCompare(N.toStringNullSafe(t.rows[i][e]))}),this.sortInfo.order=i,this.sortInfo.columnIndex=e,0==this.sortInfo.order?this.columnHeaderCells[this.sortInfo.columnIndex].classList.add("sorted-asc"):this.columnHeaderCells[this.sortInfo.columnIndex].classList.add("sorted-desc");var s=this.filteredIndex.map(function(e){return t.sizeBase.heights[e]});this.sizeBase.heights=s,this.prepareVirtualScroll(this.viewport.scrollTop,this.viewport.scrollLeft,!0),this.alterViewportOffset(),this.updateVirtualSelection(),this.alterContent(!0)}},{key:"destroy",value:function(){}}]),e}(),x=function(){function e(t,i){d()(this,e),this.RowIndex=t||0,this.ColumnIndex=i||0}return u()(e,[{key:"equals",value:function(e){return this.RowIndex==e.RowIndex&&this.ColumnIndex==e.ColumnIndex}}]),e}(),k=function e(t,i){d()(this,e),this.Start=t||new x,this.End=i||new x},I=function(){function e(){d()(this,e),this._init()}return u()(e,[{key:"_init",value:function(){this.Results=[],this.CurrentResult={},this.SearchedValue=null,this.ResultText="0/0"}},{key:"search",value:function(e,t,i,s){return null==t||""==t?(this._init(),!1):this._canContinue(t)?this.continueSearch(i):(this.CurrentResult={},this.Results=[],this.SearchedValue=t,this.ResultText="0/0",this.startSearch(e,t,s))}},{key:"startSearch",value:function(e,t,i){var s=this,n=void 0;try{n=new RegExp(t,"i")}catch(e){return!1}if(e.forEach(function(e,t){e.forEach(function(e,i){if(n.test(e)){var r={Index:s.Results.length,RowIndex:t,ColumnIndex:i};s.Results.push(r)}})}),this.Results.length<=0)return!1;var r=N.findClosest(i,this.Results,this.Results.length-1,"RowIndex");return this.CurrentResult=this.Results[r],this.ResultText=r+1+"/"+this.Results.length,!0}},{key:"_canContinue",value:function(e){return this.SearchedValue==e&&this.Results.length>0}},{key:"continueSearch",value:function(e){var t=e==p?this.CurrentResult.Index+1:this.CurrentResult.Index-1;return(e!=p||this.Results.length!=t)&&((e!=v||-1!=t)&&(this.CurrentResult=this.Results[t],this.ResultText=t+1+"/"+this.Results.length,!0))}}]),e}(),S=function(){function e(t){d()(this,e),this.rows=t,this._undoStack=[],this._redoStack=[]}return u()(e,[{key:"begin",value:function(e,t,i){this.edition={undo:{CellNode:e,value:t,height:i}}}},{key:"end",value:function(e,t){this.edition.value!=e?(this._redoStack=[],this.edition.redo={CellNode:this.edition.undo.CellNode,value:e,height:t},this._undoStack.push(this.edition),this.rows[this.edition.undo.CellNode.Cell.RowIndex][this.edition.undo.CellNode.Cell.ColumnIndex]=e):this.edition=null}},{key:"canUndo",value:function(){return this._undoStack.length>0}},{key:"undo",value:function(){var e=this._undoStack.pop();this._redoStack.push(e);var t=e.undo;return this.rows[t.CellNode.Cell.RowIndex][t.CellNode.Cell.ColumnIndex]=t.value,t.CellNode.Node.textContent=t.value,t}},{key:"canRedo",value:function(){return this._redoStack.length>0}},{key:"redo",value:function(){var e=this._redoStack.pop();this._undoStack.push(e);var t=e.redo;return this.rows[t.CellNode.Cell.RowIndex][t.CellNode.Cell.ColumnIndex]=t.value,t.CellNode.Node.textContent=t.value,t}},{key:"clear",value:function(){this._undoStack=[],this._redoStack=[]}}]),e}(),N=function(){function e(){d()(this,e)}return u()(e,null,[{key:"css",value:function(e,t){var i=void 0;return i=e.style[t]?e.style[t]:window.getComputedStyle(e)[t],"WIDTH"==t.toUpperCase()||"HEIGHT"==t.toUpperCase()?parseInt(i.replace("px","")):i}},{key:"toStringNullSafe",value:function(e){return null==e?"":e.toString()}},{key:"getClipboardText",value:function(e){return(e.clipboardData||window.clipboardData||e.originalEvent.clipboardData).getData("Text")}},{key:"findClosest",value:function(e,t,i,s){for(var n=0,r=i>0?i-1:0;r!==n;){var l=Math.floor((r-n)/2+n),o=null==s?t[l]:t[l][s],a=null==s?t[l+1]:t[l+1][s];if(o<=e&&a>e)return l;if(l===n)return r;o<=e?n=l:r=l}return i}},{key:"getByteLength",value:function(e){for(var t,i=0,s=0;s<e.length;s++)i+=(t=e.charCodeAt(s))>=0&&t<129||63728===t||t>=65377&&t<65440||t>=63729&&t<63732?1:2;return i}},{key:"uniq",value:function(e){return l()(new a.a(e))}},{key:"transpose",value:function(e){return n()(e[0]).map(function(t){return e.map(function(e){return e[t]})})}},{key:"reduceString",value:function(e){return e.reduce(this.compareLength.bind(this))}},{key:"compareLength",value:function(e,t){var i=this,s=this.toStringNullSafe(e).split("\n").reduce(function(e,t){return i.getByteLength(e)>i.getByteLength(t)?e:t}),n=this.toStringNullSafe(t).split("\n").reduce(function(e,t){return i.getByteLength(e)>i.getByteLength(t)?e:t});return this.getByteLength(s)>this.getByteLength(n)?s:n}},{key:"getStringWidth",value:function(e,t,i){var s=(this.getStringWidth.canvas||(this.getStringWidth.canvas=document.createElement("canvas"))).getContext("2d");s.font=i.font;var n=s.measureText(e);return t?parseInt(n.width+32+i.padding):parseInt(n.width+20)}},{key:"measureHeight",value:function(e,t){var i=this.toStringNullSafe(t).split("\n");return e.lineHeight*i.length+e.borderWidth}},{key:"reduceRowHeights",value:function(e,t){var i=this.measureHeight(this.styles,t);return i>e?i:e}},{key:"getSizeBase",value:function(e,t,i){var s=this;this.styles=i;var n=t.map(function(e){return e.reduce(s.reduceRowHeights.bind(s),s.styles.baseHeight)}),r=this.getStringWidth(t.length,!1,this.styles),l=this.transpose(t),o=e.map(function(e,t){return[e].concat(l[t])}).map(function(e){return e.reduce(s.compareLength.bind(s))});return{widths:[r].concat(o.map(function(e){return s.getStringWidth(e,!0,s.styles)})),heights:n,baseData:l}}}]),e}(),E=function(){function e(t,i){d()(this,e),this.container=document.createElement("div"),this.container.classList.add("filter-dropdown"),this.container.style.display="none",this.container.setAttribute("tabindex","0"),this.container.addEventListener("blur",this.onBlur.bind(this)),this.filterArea=document.createElement("div"),this.filterArea.classList.add("filter-dropdown-area"),this.filterAreaStyles={width:this.filterArea.style.width,height:this.filterArea.style.height},new MutationObserver(this.onResize.bind(this)).observe(this.filterArea,{attriblutes:!0,attributeFilter:["style"]});var s=document.createElement("div");s.classList.add("search-text-area");var n=document.createElement("span");this.searchText=document.createElement("input"),this.searchText.type="text",this.searchText.classList.add("search-text"),this.searchText.addEventListener("keyup",this.filter.bind(this));var r=document.createElement("div");r.classList.add("clear-text"),r.innerHTML="&#10006;",n.append(this.searchText,r),s.appendChild(n),this.dropdownArea=document.createElement("div"),this.dropdownArea.classList.add("dropdown"),this.dropdownArea.addEventListener("scroll",this.onScroll.bind(this)),this.options=document.createElement("ul"),this.options.classList.add("options"),this.viewport=document.createElement("div"),this.viewport.classList.add("dropdown-viewport"),this.viewport.appendChild(this.options),this.dropdownArea.appendChild(this.viewport);var l=document.createElement("div");l.classList.add("btn-area");var o=document.createElement("div");o.classList.add("btns");var a=document.createElement("button");a.classList.add("btn","btn-sub"),a.textContent="OK",a.addEventListener("click",this._onOKButtonClick.bind(this));var h=document.createElement("button");h.classList.add("btn","btn-sub"),h.textContent="Clear",h.addEventListener("click",this.clear.bind(this));var c=document.createElement("button");c.classList.add("btn","btn-sub"),c.addEventListener("click",this.close.bind(this)),c.textContent="Cancel",o.append(a,h,c),l.appendChild(o),this.filterArea.append(s,this.dropdownArea,l),this.container.append(this.filterArea),t.appendChild(this.container),this.animationFrame=null,this._init(),this.afterDropdownClose=i.afterDropdownClose,this.clearFilter=i.clearFilter,this.calculationBaseStyles={rowHeight:20,font:"12px Verdana,Arial,sans-serif",width:200,height:150}}return u()(e,[{key:"_init",value:function(){this.filtered=!1,this.IsOpened=!1,this.visibleIndex=[],this.filteredIndex=[],this._rawIndex=[],this.checkedIndex=new a.a,this.filteredValue=null,this.prev={filteredIndex:null,checkedIndex:null,filteredValue:null},this.itemCount=0,this.currentColumnIndex=-1,this.values=null,this.selectedValues=[],this.visibleNodes=null,this.nodeOffsetY=0}},{key:"open",value:function(e,t,i){this.IsOpened=!0,this.currentColumnIndex=e,this.values=l()(t),this.values.unshift("Select All"),this.itemCount=t.length,this.selectedValues=[],this.filtered&&this.currentColumnIndex==this.filteredColumn?(this.filteredIndex=this.prev.filteredIndex,this._rawIndex=t.map(function(e,t){return t}),this.checkedIndex=this.prev.checkedIndex,this.filteredValue=this.prev.filteredValue,this.searchText.value=this.filteredValue):(this.filterArea.style.width=this.filterAreaStyles.width,this.filterArea.style.height=this.filterAreaStyles.height,this.filteredIndex=t.map(function(e,t){return t}),this._rawIndex=this.filteredIndex,this.checkedIndex=new a.a,this.filteredValue=null,this.searchText.value=this.filteredValue),this._createOptions();var s=i.width-this.calculationBaseStyles.width;this.container.style.top=i.Y+"px",this.container.style.left=i.X+s+"px",this.container.style.display="block",this.dropdownArea.scrollTop=0,this.dropdownArea.scrollLeft=0,this.container.focus()}},{key:"_createOptions",value:function(e){var t=this;this._prepareVirtualScroll(0,!0),this.viewport.style.height=this.totalContentHeight+"px",this.viewport.style.width=N.getStringWidth(N.reduceString(this.values),!0,this.calculationBaseStyles)+"px",this.options.innerHTML="",this.visibleNodes=[];var i=document.createDocumentFragment();this.visibleIndex.forEach(function(s){var n=document.createElement("li"),r=document.createElement("label");r.classList.add("option");var l=document.createElement("input");0==s&&l.classList.add("select-all"),l.type="checkbox",e&&(l.checked=!0),l.addEventListener("change",t.toggleCheck.bind(t)),t.filteredColumn==t.currentColumnIndex&&t.checkedIndex.has(s)&&(l.checked=!0);var o=document.createElement("span");o.textContent=t.values[s],r.append(l,o),n.append(r),i.append(n),t.visibleNodes.push(r)}),this.options.append(i)}},{key:"close",value:function(){this.IsOpened=!1,this.container.style.display="none"}},{key:"filter",value:function(e){var t=this;if(null!=e.target.value&&""!=e.target.value){this.filteredValue=e.target.value,this._rawIndex=this.filteredIndex,this.filteredIndex=[];var i=N.toStringNullSafe(e.target.value).toUpperCase();this.values.forEach(function(e,s){(0==s||e.toUpperCase().includes(i))&&t.filteredIndex.push(s)}),this._createOptions(!0),this.checkedIndex=new a.a(this.filteredIndex)}else this.clearTextFilter()}},{key:"clearTextFilter",value:function(){this.filteredValue=null,this.filteredIndex=this._rawIndex,this.checkedIndex=new a.a,this._createOptions()}},{key:"clear",value:function(){this.filtered=!1,this.close(),this.clearFilter&&this.clearFilter()}},{key:"toggleCheck",value:function(e){e.target.classList.contains("select-all")?e.target.checked?(this.options.querySelectorAll("input").forEach(function(e,t){t>0&&(e.checked=!0)}),this.checkedIndex=new a.a(this.filteredIndex)):(this.options.querySelectorAll("input").forEach(function(e,t){t>0&&(e.checked=!1)}),this.checkedIndex=new a.a):e.target.checked?this.checkedIndex.add(this.values.indexOf(e.target.nextElementSibling.textContent)):this.checkedIndex.delete(this.values.indexOf(e.target.nextElementSibling.textContent))}},{key:"_onOKButtonClick",value:function(e){var t=this;this.filtered=t.checkedIndex.size!=t.itemCount&&t.checkedIndex.size>0,this.filtered&&(this.filteredColumn=this.currentColumnIndex,this.SelectedValues=l()(this.checkedIndex).map(function(e){return t.values[e]}),this.prev.filteredIndex=this.filteredIndex,this.prev.checkedIndex=this.checkedIndex,this.prev.filteredValue=this.filteredValue),this.afterDropdownClose&&this.afterDropdownClose(this.currentColumnIndex,this.SelectedValues),this.close()}},{key:"onScroll",value:function(e){var t=this;this.animationFrame&&window.cancelAnimationFrame(this.animationFrame),this.animationFrame=window.requestAnimationFrame(function(){return t.doVirtualScroll(e)})}},{key:"_prepareVirtualScroll",value:function(e,t){t&&(this.totalContentHeight=this.itemCount*this.calculationBaseStyles.rowHeight),this.startNode=Math.floor(e/this.calculationBaseStyles.rowHeight)-0,this.startNode=Math.max(0,this.startNode);var i=Math.ceil(this.calculationBaseStyles.height/this.calculationBaseStyles.rowHeight)+0;i=Math.min(this.itemCount-this.startNode,i),this.nodeOffsetY=this.startNode*this.calculationBaseStyles.rowHeight,this.visibleIndex=this.filteredIndex.slice(this.startNode,this.startNode+i)}},{key:"doVirtualScroll",value:function(e){var t=this;this._prepareVirtualScroll(e.target.scrollTop,!1),this.visibleIndex.forEach(function(e,i){0==e?t.visibleNodes[i].childNodes[0].classList.add("select-all"):t.visibleNodes[i].childNodes[0].classList.remove("select-all"),t.visibleNodes[i].childNodes[0].checked=t.checkedIndex.has(e),t.visibleNodes[i].childNodes[1].textContent=t.values[e]}),this.options.style.top=this.nodeOffsetY+"px"}},{key:"onBlur",value:function(e){this.container.contains(e.relatedTarget)||this.close()}},{key:"onResize",value:function(e){this.calculationBaseStyles.height=parseInt(this.filterArea.style.height.replace("px","")),this._createOptions()}}]),e}();t.a=w},yDJI:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.1995365a4fe579c590f5.js.map